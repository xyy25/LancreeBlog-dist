import { _ as _export_sfc, r as resolveComponent, o as openBlock, c as createElementBlock, a as createBaseVNode, e as createTextVNode, b as createVNode, d as withCtx, f as createStaticVNode } from "./app-5d65d1f1.js";
const _sfc_main = {};
const _hoisted_1 = /* @__PURE__ */ createStaticVNode('<p>这是已经在首页的白天模式实装的特效，这里大概介绍一下它的实现代码。</p><h2 id="flowers-vue-绘制花瓣飞舞" tabindex="-1"><a class="header-anchor" href="#flowers-vue-绘制花瓣飞舞" aria-hidden="true">#</a> <code>Flowers.vue</code> 绘制花瓣飞舞</h2><p>采用<code>canvas</code>画布实现。</p><p>花瓣分为前、后两个图层，<code>z-index</code>分别为<code>10</code>和<code>-10</code>，各用一个画布。</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower-canvas<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>frontCanvas<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>h<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower-canvas front<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>backCanvas<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>h<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower-canvas back<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n      您的浏览器不支持canvas请升级！\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>css样式如下：</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">\n<span class="token selector">.flower-canvas</span> <span class="token punctuation">{</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>\n  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.front</span> <span class="token punctuation">{</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> 10<span class="token punctuation">;</span>\n  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">blur</span><span class="token punctuation">(</span>1px<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.back</span> <span class="token punctuation">{</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> -10<span class="token punctuation">;</span>\n  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">blur</span><span class="token punctuation">(</span>.25px<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="脚本实现" tabindex="-1"><a class="header-anchor" href="#脚本实现" aria-hidden="true">#</a> 脚本实现</h3>', 8);
const _hoisted_9 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  "(",
  -1
  /* HOISTED */
);
const _hoisted_10 = /* @__PURE__ */ createBaseVNode(
  "rt",
  null,
  "windStrength",
  -1
  /* HOISTED */
);
const _hoisted_11 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  ")",
  -1
  /* HOISTED */
);
const _hoisted_12 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  "(",
  -1
  /* HOISTED */
);
const _hoisted_13 = /* @__PURE__ */ createBaseVNode(
  "rt",
  null,
  "windAngle",
  -1
  /* HOISTED */
);
const _hoisted_14 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  ")",
  -1
  /* HOISTED */
);
const _hoisted_15 = /* @__PURE__ */ createStaticVNode('<p>ts脚本部分概括如下：</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">\n<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> onMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> isMobile<span class="token punctuation">,</span> inRange<span class="token punctuation">,</span> randElem<span class="token punctuation">,</span> randFloat<span class="token punctuation">,</span> type Range <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../utils.ts&#39;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> frontCanvas <span class="token operator">=</span> ref<span class="token operator">&lt;</span>HTMLCanvasElement<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> backCanvas <span class="token operator">=</span> ref<span class="token operator">&lt;</span>HTMLCanvasElement<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token literal-property property">windStrength</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span>\n    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">windAngle</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span>\n    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// canvas画布的宽高，受resize事件响应式变动</span>\n<span class="token keyword">const</span> w <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1920</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> h <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">280</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 花瓣类，定义每一片花瓣的共同属性</span>\n<span class="token keyword">class</span> <span class="token class-name">Flower</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">width</span><span class="token operator">:</span> number<span class="token punctuation">;</span> \n    <span class="token literal-property property">height</span><span class="token operator">:</span> number<span class="token punctuation">;</span>\n    <span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">;</span> \n    <span class="token literal-property property">y</span><span class="token operator">:</span> number<span class="token punctuation">;</span> \n    <span class="token literal-property property">rotate</span><span class="token operator">:</span> number<span class="token punctuation">;</span>\n    <span class="token literal-property property">speedX</span><span class="token operator">:</span> number<span class="token punctuation">;</span> \n    <span class="token literal-property property">speedY</span><span class="token operator">:</span> number<span class="token punctuation">;</span> \n    <span class="token literal-property property">speedR</span><span class="token operator">:</span> number<span class="token punctuation">;</span>\n    <span class="token literal-property property">scale</span><span class="token operator">:</span> number<span class="token punctuation">;</span>\n    <span class="token literal-property property">img</span><span class="token operator">:</span> HTMLImageElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n    <span class="token function">constructor</span><span class="token punctuation">(</span>\n        <span class="token keyword">public</span> <span class="token literal-property property">scaleRange</span><span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> Range<span class="token punctuation">,</span>\n        <span class="token keyword">public</span> <span class="token literal-property property">speedXRange</span><span class="token operator">:</span> Range<span class="token punctuation">,</span>\n        <span class="token keyword">public</span> <span class="token literal-property property">speedYRange</span><span class="token operator">:</span> Range\n    <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//构造函数初始化</span>\n\n    <span class="token comment">// 初始化加载图片</span>\n    <span class="token function">show</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> CanvasRenderingContext2D<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 重置花瓣位置</span>\n    <span class="token function">regen</span><span class="token punctuation">(</span>dx<span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">dy</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">rand</span><span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 每帧花瓣绘制逻辑</span>\n    <span class="token function">draw</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> CanvasRenderingContext2D<span class="token punctuation">,</span> <span class="token literal-property property">rotate</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 每帧花瓣移动逻辑，会受风的影响</span>\n    <span class="token function">move</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> CanvasRenderingContext2D<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="flower类实现" tabindex="-1"><a class="header-anchor" href="#flower类实现" aria-hidden="true">#</a> Flower类实现</h4><p>图片加载方法。</p><p><code>Flower.show</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token function">show</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> CanvasRenderingContext2D<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 随机图片</span>\n    <span class="token keyword">const</span> src <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span> <span class="token operator">?</span> <span class="token string">&quot;/images/flower1.svg&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;/images/flower2.svg&quot;</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>\n\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">regen</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>speedX<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>speedY<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 画初始位置的花瓣</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> ratio <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>img<span class="token operator">!</span><span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>img<span class="token operator">!</span><span class="token punctuation">.</span>height<span class="token punctuation">;</span> <span class="token comment">// 宽高比，用于缩放</span>\n        <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>ratio <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scale<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scale<span class="token punctuation">]</span><span class="token punctuation">;</span>\n        ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>img<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>花瓣位置的初始化方法，当花瓣加载和飞出屏幕时会调用。</p><p><code>Flower.regen</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token function">regen</span><span class="token punctuation">(</span>dx<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> dy<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> rand<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 随机大小</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>scale <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scaleRange<span class="token punctuation">)</span>\n        <span class="token operator">?</span> <span class="token function">randElem</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scaleRange<span class="token punctuation">)</span>\n        <span class="token operator">:</span> <span class="token function">randFloat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scaleRange<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>speedX<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>speedY<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">randFloat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>speedXRange<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">randFloat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>speedYRange<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// 随机初位置</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span>rand<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">randFloat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> w<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">randFloat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">]</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token comment">// 根据宽高比、当前速度决定其随机分别在水平边界、垂直边界上生成的概率</span>\n        <span class="token keyword">const</span> ratio <span class="token operator">=</span> <span class="token punctuation">(</span>w<span class="token punctuation">.</span>value <span class="token operator">+</span> dy<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>w<span class="token punctuation">.</span>value <span class="token operator">+</span> h<span class="token punctuation">.</span>value <span class="token operator">+</span> dx <span class="token operator">+</span> dy<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">const</span> <span class="token punctuation">[</span>initX<span class="token punctuation">,</span> initY<span class="token punctuation">]</span> <span class="token operator">=</span>  Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> ratio\n        <span class="token comment">// 根据当前速度正交分量的正负，决定其在垂直边界的左/右、水平边界的上/下生成</span>\n            <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token function">randFloat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> w<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span> dy <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> h<span class="token punctuation">.</span>value<span class="token punctuation">]</span>\n            <span class="token operator">:</span> <span class="token punctuation">[</span>dx <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> w<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token function">randFloat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n        <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>initX<span class="token punctuation">,</span> initY<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>花瓣的每帧绘制方法，包含旋转。</p><p><code>Flower.draw</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token function">draw</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> CanvasRenderingContext2D<span class="token punctuation">,</span> rotate<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>rotate<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>img<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ctx<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>rotate <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>img<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ctx<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>花瓣的每帧移动逻辑。</p><p><code>Flower.move</code></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token function">move</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> CanvasRenderingContext2D<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 获取当前风力和风向，与花瓣固有速度求和，计算dx和dy</span>\n    <span class="token keyword">const</span> wStr <span class="token operator">=</span> props<span class="token punctuation">.</span>windStrength<span class="token punctuation">,</span> wAgl <span class="token operator">=</span> props<span class="token punctuation">.</span>windAngle <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> dx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>speedX <span class="token operator">+</span> <span class="token punctuation">(</span>wStr <span class="token operator">?</span> wStr <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>wAgl<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> dy <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>speedY <span class="token operator">+</span> <span class="token punctuation">(</span>wStr <span class="token operator">?</span> wStr <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>wAgl<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> width<span class="token operator">:</span> cw<span class="token punctuation">,</span> height<span class="token operator">:</span> ch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>\n    <span class="token comment">// 当花瓣飞出屏幕时，重置其位置，否则改变位置</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">inRange</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> dx<span class="token punctuation">,</span> <span class="token operator">-</span>cw<span class="token punctuation">,</span> w<span class="token punctuation">.</span>value <span class="token operator">+</span> cw<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">inRange</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+</span> dy<span class="token punctuation">,</span> <span class="token operator">-</span>ch<span class="token punctuation">,</span> h<span class="token punctuation">.</span>value <span class="token operator">+</span> ch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">regen</span><span class="token punctuation">(</span>dx<span class="token punctuation">,</span> dy<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> dx<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+</span> dy<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>rotate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>rotate <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>speedR<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">360</span><span class="token punctuation">;</span>\n    <span class="token comment">// 绘制</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rotate<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="挂载初始化" tabindex="-1"><a class="header-anchor" href="#挂载初始化" aria-hidden="true">#</a> 挂载初始化</h4><p>组件挂载时，对每个图层初始化花瓣飞舞<code>canvas</code>画布。</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> scales <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12.5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">17.5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22.5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> speedXRange <span class="token operator">=</span> <span class="token punctuation">{</span> min<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> max<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> speedYRange <span class="token operator">=</span> <span class="token punctuation">{</span> min<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> max<span class="token operator">:</span> <span class="token number">1.5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> FlowerCounts <span class="token operator">=</span> <span class="token function">isMobile</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  w<span class="token punctuation">.</span>value <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">;</span>\n  h<span class="token punctuation">.</span>value <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>\n\n  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>i<span class="token punctuation">,</span> canvas<span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token punctuation">[</span>backCanvas<span class="token punctuation">.</span>value<span class="token punctuation">,</span> frontCanvas<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>canvas<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ctx<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">const</span> flowers<span class="token operator">:</span> Flower<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> FlowerCounts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">const</span> fr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flower</span><span class="token punctuation">(</span>scales<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> speedXRange<span class="token punctuation">,</span> speedYRange<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      flowers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      fr<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 20ms一帧，控制画布内所有花瓣的移动</span>\n    <span class="token keyword">function</span> <span class="token function">movee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ctx<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>\n      ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> w<span class="token punctuation">.</span>value<span class="token punctuation">,</span> h<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> flower <span class="token keyword">of</span> flowers<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        flower<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">setInterval</span><span class="token punctuation">(</span>movee<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">movee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 监听窗口大小改变事件</span>\n    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;resize&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n      w<span class="token punctuation">.</span>value <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">;</span>\n      h<span class="token punctuation">.</span>value <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="windbase-vue-随机风力产生" tabindex="-1"><a class="header-anchor" href="#windbase-vue-随机风力产生" aria-hidden="true">#</a> <code>WindBase.vue</code> 随机风力产生</h2>', 19);
const _hoisted_34 = /* @__PURE__ */ createBaseVNode(
  "code",
  null,
  "Flowers",
  -1
  /* HOISTED */
);
const _hoisted_35 = /* @__PURE__ */ createBaseVNode(
  "code",
  null,
  "WindBase",
  -1
  /* HOISTED */
);
const _hoisted_36 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  "(",
  -1
  /* HOISTED */
);
const _hoisted_37 = /* @__PURE__ */ createBaseVNode(
  "rt",
  null,
  "slot",
  -1
  /* HOISTED */
);
const _hoisted_38 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  ")",
  -1
  /* HOISTED */
);
const _hoisted_39 = /* @__PURE__ */ createStaticVNode('<div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wind-base<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">:strength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>windStrength<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:direction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>windAngle<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>', 1);
const _hoisted_40 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  "(",
  -1
  /* HOISTED */
);
const _hoisted_41 = /* @__PURE__ */ createBaseVNode(
  "rt",
  null,
  "slot",
  -1
  /* HOISTED */
);
const _hoisted_42 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  ")",
  -1
  /* HOISTED */
);
const _hoisted_43 = /* @__PURE__ */ createBaseVNode(
  "code",
  null,
  "WindBase",
  -1
  /* HOISTED */
);
const _hoisted_44 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  "(",
  -1
  /* HOISTED */
);
const _hoisted_45 = /* @__PURE__ */ createBaseVNode(
  "rt",
  null,
  "windStrength",
  -1
  /* HOISTED */
);
const _hoisted_46 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  ")",
  -1
  /* HOISTED */
);
const _hoisted_47 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  "(",
  -1
  /* HOISTED */
);
const _hoisted_48 = /* @__PURE__ */ createBaseVNode(
  "rt",
  null,
  "windAngle",
  -1
  /* HOISTED */
);
const _hoisted_49 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  ")",
  -1
  /* HOISTED */
);
const _hoisted_50 = /* @__PURE__ */ createBaseVNode(
  "code",
  null,
  "Flowers",
  -1
  /* HOISTED */
);
const _hoisted_51 = /* @__PURE__ */ createStaticVNode('<p>目前只有<code>Flowers</code>会受风力调制，以后可能还会TODO其它的特效，比如下雨。</p><p>在父组件中：</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>\n  ...\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>WindBase</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ strength, direction }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Flowers</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!isDarkMode<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:wind-strength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>strength<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:wind-angle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>direction<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>WindBase</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>', 3);
const _hoisted_54 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  "(",
  -1
  /* HOISTED */
);
const _hoisted_55 = /* @__PURE__ */ createBaseVNode(
  "rt",
  null,
  "windStrength",
  -1
  /* HOISTED */
);
const _hoisted_56 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  ")",
  -1
  /* HOISTED */
);
const _hoisted_57 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  "(",
  -1
  /* HOISTED */
);
const _hoisted_58 = /* @__PURE__ */ createBaseVNode(
  "rt",
  null,
  "windAngle",
  -1
  /* HOISTED */
);
const _hoisted_59 = /* @__PURE__ */ createBaseVNode(
  "rp",
  null,
  ")",
  -1
  /* HOISTED */
);
const _hoisted_60 = /* @__PURE__ */ createBaseVNode(
  "code",
  null,
  "WindBase",
  -1
  /* HOISTED */
);
const _hoisted_61 = /* @__PURE__ */ createStaticVNode('<p>组件会在一段时间内概率（此处为每<code>5</code>秒有<code>20%</code>的概率）触发一次风力的改变。</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">\n<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> onMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> isMobile<span class="token punctuation">,</span> randFloat<span class="token punctuation">,</span> randInt<span class="token punctuation">,</span> passTo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../utils.ts&#39;</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Flowers <span class="token keyword">from</span> <span class="token string">&#39;./Flowers.vue&#39;</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 风力风向</span>\n<span class="token keyword">const</span> windStrength <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> windAngle <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// 平滑过渡</span>\n<span class="token keyword">const</span> windStrengthTo <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> windAngleTo <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> windStep <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">let</span> <span class="token literal-property property">itv</span><span class="token operator">:</span> NodeJS<span class="token punctuation">.</span>Timeout <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 监测风力风向的变化，提供风力改变的平滑过渡</span>\n<span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span>windStrengthTo<span class="token punctuation">,</span> windAngleTo<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">nvals</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    itv <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n        windStrength<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">passTo</span><span class="token punctuation">(</span>windStrength<span class="token punctuation">.</span>value<span class="token punctuation">,</span> nvals<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> windStep<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        windAngle<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">passTo</span><span class="token punctuation">(</span>windAngle<span class="token punctuation">.</span>value<span class="token punctuation">,</span> nvals<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> windStep<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">if</span><span class="token punctuation">(</span>windStrength<span class="token punctuation">.</span>value <span class="token operator">===</span> nvals<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> windAngle<span class="token punctuation">.</span>value <span class="token operator">===</span> nvals<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">clearInterval</span><span class="token punctuation">(</span>itv<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 随机改变风力风向（仅在电脑端启用）</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isMobile</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> \n        <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                itv <span class="token operator">&amp;&amp;</span> <span class="token function">clearInterval</span><span class="token punctuation">(</span>itv<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                windStrengthTo<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">randFloat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                windAngleTo<span class="token punctuation">.</span>value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.5</span> <span class="token operator">?</span> <span class="token function">randInt</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">randInt</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                windStep<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">randFloat</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 风向改变的加速度</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中<code>passTo</code>函数很容易实现，就是将参数<code>val</code>向目标参数<code>dest</code>的方向移动<code>step</code>值。</p><p>当<code>windStrengthTo</code>和<code>windAngleTo</code>改变时，现有的<code>windStrength</code>、<code>windAngle</code>的值将会自动向它们移动。</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">passTo</span> <span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> dest<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> step<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span>dest <span class="token operator">&lt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        val <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>val <span class="token operator">-</span> step<span class="token punctuation">,</span> dest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>dest <span class="token operator">&gt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        val <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>val <span class="token operator">+</span> step<span class="token punctuation">,</span> dest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">return</span> val<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>', 5);
function _sfc_render(_ctx, _cache) {
  const _component_rb = resolveComponent("rb");
  return openBlock(), createElementBlock("div", null, [
    _hoisted_1,
    createBaseVNode("p", null, [
      createTextVNode("组件定义了两个父级传入属性：当前的"),
      createBaseVNode("strong", null, [
        createBaseVNode("ruby", null, [
          createVNode(_component_rb, null, {
            default: withCtx(() => [
              createTextVNode("风力")
            ]),
            _: 1
            /* STABLE */
          }),
          _hoisted_9,
          _hoisted_10,
          _hoisted_11
        ])
      ]),
      createTextVNode("和"),
      createBaseVNode("strong", null, [
        createBaseVNode("ruby", null, [
          createVNode(_component_rb, null, {
            default: withCtx(() => [
              createTextVNode("风向")
            ]),
            _: 1
            /* STABLE */
          }),
          _hoisted_12,
          _hoisted_13,
          _hoisted_14
        ])
      ]),
      createTextVNode("，会影响花瓣的速度。")
    ]),
    _hoisted_15,
    createBaseVNode("p", null, [
      _hoisted_34,
      createTextVNode("组件被装载在一个名为"),
      _hoisted_35,
      createTextVNode("的提供随机风力的组件中。该组件会为"),
      createBaseVNode("strong", null, [
        createBaseVNode("ruby", null, [
          createVNode(_component_rb, null, {
            default: withCtx(() => [
              createTextVNode("插槽")
            ]),
            _: 1
            /* STABLE */
          }),
          _hoisted_36,
          _hoisted_37,
          _hoisted_38
        ])
      ]),
      createTextVNode("中的组件提供统一的风力管理。")
    ]),
    _hoisted_39,
    createBaseVNode("p", null, [
      createTextVNode("通过"),
      createBaseVNode("ruby", null, [
        createVNode(_component_rb, null, {
          default: withCtx(() => [
            createTextVNode("插槽")
          ]),
          _: 1
          /* STABLE */
        }),
        _hoisted_40,
        _hoisted_41,
        _hoisted_42
      ]),
      createTextVNode("机制，可直接将"),
      _hoisted_43,
      createTextVNode("所生成的当前"),
      createBaseVNode("ruby", null, [
        createVNode(_component_rb, null, {
          default: withCtx(() => [
            createTextVNode("风力")
          ]),
          _: 1
          /* STABLE */
        }),
        _hoisted_44,
        _hoisted_45,
        _hoisted_46
      ]),
      createTextVNode("和"),
      createBaseVNode("ruby", null, [
        createVNode(_component_rb, null, {
          default: withCtx(() => [
            createTextVNode("风向")
          ]),
          _: 1
          /* STABLE */
        }),
        _hoisted_47,
        _hoisted_48,
        _hoisted_49
      ]),
      createTextVNode("参数传入"),
      _hoisted_50,
      createTextVNode("组件中。")
    ]),
    _hoisted_51,
    createBaseVNode("p", null, [
      createTextVNode("至于"),
      createBaseVNode("ruby", null, [
        createVNode(_component_rb, null, {
          default: withCtx(() => [
            createTextVNode("风力")
          ]),
          _: 1
          /* STABLE */
        }),
        _hoisted_54,
        _hoisted_55,
        _hoisted_56
      ]),
      createTextVNode("和"),
      createBaseVNode("ruby", null, [
        createVNode(_component_rb, null, {
          default: withCtx(() => [
            createTextVNode("风向")
          ]),
          _: 1
          /* STABLE */
        }),
        _hoisted_57,
        _hoisted_58,
        _hoisted_59
      ]),
      createTextVNode("参数如何生成，这是由"),
      _hoisted_60,
      createTextVNode("组件的脚本所实现。")
    ]),
    _hoisted_61
  ]);
}
const flowers_html = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render], ["__file", "flowers.html.vue"]]);
export {
  flowers_html as default
};
